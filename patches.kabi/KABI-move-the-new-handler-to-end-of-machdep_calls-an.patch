From a919554f94d8dcf94079aea1357cc43520f300cd Mon Sep 17 00:00:00 2001
From: Michal Suchanek <msuchanek@suse.de>
Date: Tue, 3 Jul 2018 16:10:11 +0200
Subject: [PATCH 24/24] KABI: move the new handler to end of machdep_calls and
 hide it from genksyms

References: bsc#1094244
Patch-mainline: never, KABI

Signed-off-by: Michal Suchanek <msuchanek@suse.de>
---
 arch/powerpc/include/asm/machdep.h | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/arch/powerpc/include/asm/machdep.h b/arch/powerpc/include/asm/machdep.h
index c73587a38e6e..68a27228ceaf 100644
--- a/arch/powerpc/include/asm/machdep.h
+++ b/arch/powerpc/include/asm/machdep.h
@@ -145,7 +145,6 @@ struct machdep_calls {
 
 	/* Early exception handlers called in realmode */
 	int		(*hmi_exception_early)(struct pt_regs *regs);
-	long		(*machine_check_early)(struct pt_regs *regs);
 
 	/* Called during machine check exception to retrive fixup address. */
 	bool		(*mce_check_early_recovery)(struct pt_regs *regs);
@@ -257,6 +256,10 @@ struct machdep_calls {
 #ifdef CONFIG_ARCH_RANDOM
 	int (*get_random_seed)(unsigned long *v);
 #endif
+
+#ifndef __GENKSYMS__
+	long		(*machine_check_early)(struct pt_regs *regs);
+#endif
 };
 
 extern void e500_idle(void);
-- 
2.13.7

