From 2ba40b6f608964479b4e274b3aa1211d10cd6b0e Mon Sep 17 00:00:00 2001
From: Egbert Eich <eich@suse.de>
Date: Tue, 18 Jul 2017 16:43:08 +0200
Message-id: <20170718144320.8354-3-tiwai@suse.de>
Subject: [PATCH 02/14] drm/mgag200: Add additional limits for certain G200
 variants
Patch-mainline: Submitted, dri-devel ML
References: bnc#893040

According to the use UMS X.Org driver G200 WB chips don't support
doublescan

Signed-off-by: Egbert Eich <eich@suse.de>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/gpu/drm/mgag200/mgag200_mode.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/mgag200/mgag200_mode.c b/drivers/gpu/drm/mgag200/mgag200_mode.c
index 1b2b117a48d1..ca5a6df98fa3 100644
--- a/drivers/gpu/drm/mgag200/mgag200_mode.c
+++ b/drivers/gpu/drm/mgag200/mgag200_mode.c
@@ -1734,6 +1734,7 @@ static struct drm_connector *mga_vga_init(struct drm_device *dev)
 {
 	struct drm_connector *connector;
 	struct mga_connector *mga_connector;
+	struct mga_device *mdev = dev->dev_private;
 
 	mga_connector = kzalloc(sizeof(struct mga_connector), GFP_KERNEL);
 	if (!mga_connector)
@@ -1742,7 +1743,7 @@ static struct drm_connector *mga_vga_init(struct drm_device *dev)
 	connector = &mga_connector->base;
 
 	connector->interlace_allowed = true;
-	connector->doublescan_allowed = true;
+	connector->doublescan_allowed = (mdev->type == G200_WB) ? false : true;
 
 	drm_connector_init(dev, connector,
 			   &mga_vga_connector_funcs, DRM_MODE_CONNECTOR_VGA);
-- 
2.13.2

