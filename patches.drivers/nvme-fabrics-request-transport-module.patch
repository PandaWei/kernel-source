From: Sagi Grimberg <sagi@grimberg.me>
Date: Sun, 24 Sep 2017 16:15:55 +0300
Subject: nvme-fabrics: request transport module
Patch-mainline: v4.15-rc1
Git-commit: d1f1071f8151355ec149117238e9c5aa6404ca9f
References: FATE#323952, FATE#322506

Help userspace to make sure transport module is loaded.

Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
Signed-off-by: Christoph Hellwig <hch@lst.de>
---
 drivers/nvme/host/fabrics.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/drivers/nvme/host/fabrics.c
+++ b/drivers/nvme/host/fabrics.c
@@ -841,6 +841,9 @@ nvmf_create_ctrl(struct device *dev, con
 	if (ret)
 		goto out_free_opts;
 
+
+	request_module("nvme-%s", opts->transport);
+
 	/*
 	 * Check the generic options first as we need a valid transport for
 	 * the lookup below.  Then clear the generic flags so that transport
